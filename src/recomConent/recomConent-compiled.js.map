{"version":3,"sources":["recomConent.js"],"names":[],"mappings":"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","file":"recomConent-compiled.js","sourcesContent":["/**\n * Created by cvtt on 2017/3/20.\n */\n/**\n * Created by cvtt on 2017/3/20.\n */\n\nimport React, { Component } from 'react'\nimport './css/recomConent.css'\nimport service from '../services/movieService.js'\nimport {RecomData} from './data/recom.js'\nclass RecomConent extends Component {\n    constructor(props) {\n        super(props)\n        this.state={\n            isLoading:true,\n            response:false,\n            datamessage:{},\n            detailData:[],\n            lastOrgId:'',\n            messages:{\n                count:20,\n                beginOrgId:0,\n                userId:''\n            },\n            Ios:{\n                orgId:'',\n                orgType:'',\n                orgShortName:'',\n                orgPortrait:'',\n            }\n        }\n    }\n    componentWillMount(){\n        this.state.messages.userId = parseInt(JSON.parse(this.props.userId).userId)\n    }\n    componentDidMount(){\n\n        this.fetch(this.state.messages)\n    }\n    componentDidUpdate(){ //检测到state 和 props 变化就执行\n          if(this.refs.scroll_container){\n              this.addEventListener()\n          }\n    }\n\n    getLianDataCard =(Portrait,Id,RelationType,Type,ShortName,FullName,ContactName,Email,IndustryList,NetFlag,Th)=>{\n\n\n           var Iosmess = Object.assign({},this.state.Ios)\n            Iosmess.orgId = Id\n            Iosmess.orgType = Type\n            Iosmess.orgShortName = ShortName\n            Iosmess.orgPortrait = Portrait\n           var Strmess = JSON.stringify(Iosmess)\n        if(NetFlag == '1'){\n            var uuu = navigator.userAgent;\n            var isAndroid=uuu.indexOf('Android') > -1 || uuu.indexOf('Linux') > -1;\n            var isIos=!!uuu.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/)==true;\n            if(isIos) {\n                window.webkit && window.webkit.messageHandlers.gotoWebsite.postMessage(Strmess)\n                return\n            }else if(isAndroid){\n                return  window.androidJsInterface && window.androidJsInterface.lianWebMainActivityLauncher(ShortName,Portrait,Id.toString(),RelationType.toString(),Type)\n\n            }\n        }else if(NetFlag == '0' ){\n\n            var uuu = navigator.userAgent;\n            var isAndroid=uuu.indexOf('Android') > -1 || uuu.indexOf('Linux') > -1;\n            var isIos=!!uuu.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/)==true;\n            if(isIos) {\n               window.webkit && window.webkit.messageHandlers.gotoOrgDetail.postMessage(Strmess)\n                return\n            }else if(isAndroid){\n                return   window.androidJsInterface && window.androidJsInterface.intationOrgCardActivityLauncher(Portrait,Id,Type,ShortName,FullName,ContactName,Email,JSON.stringify(IndustryList))\n\n            }\n        }\n    }\n    addEventListener=()=>{\n        const _this=this\n        this.props.pullUpLoading.addEventListener('scroll',(e)=>{\n\n            e.stopPropagation\n\n            if(e.target.scrollHeight <=e.target.scrollTop + e.target.offsetHeight){\n                if(_this.state.isButton){\n                    return\n                }\n                // 在发送请求之前将上一次的 orgId 回传\n                if(this.state.datamessage.flag ==1){\n                    return\n                }\n\n                _this.fetch(this.state.messages,this.state.lastOrgId)\n                _this.setState({isButton:true})\n            }\n        })\n    }\n    fetch = (messages,beginOrgId) => {\n        var _this = this // 保存全局 this\n        let message = Object.assign({}, messages)\n        message.beginOrgId = this.state.lastOrgId && beginOrgId\n        const messageStr = JSON.stringify(message)\n        let detailData = [].concat(this.state.detailData)\n        const promise = service.getRecomConentData(messageStr)\n\n        promise.then((json) => {\n\n            if(json =='' ){\n                this.setState({response:true,isLoading:false})\n                return\n            }\n            if(json && JSON.parse(json).code ){\n                this.setState({response:true,isLoading:false})\n                return\n            }\n            json = JSON.parse(json)\n            _this.setState({datamessage: json, isLoading: false})\n            _this.setState({lastOrgId: json.lastOrgId})\n            if (detailData.length > 0) {\n                detailData = detailData.concat(json.orgList)\n            } else {\n                detailData = json.orgList\n            }\n            // 获取到数据之后 去掉遮罩 ，加载数据提示去掉\n            _this.setState({ // 同步还是异步\n                isLoading: false,\n                detailData: detailData,\n                messages: message,\n            })\n\n        }),reason =>{\n            console.error('onRejected function called: ', reason )\n        }\n    }\n\n    handleOrign =()=>{\n        return(\n            <div className='noneOrginRecom'>\n                <div className='noneOrginImage' ref=\"scroll_container\">\n                    <img src={require('../images/noneOrign.png')} alt=\"\"/>\n                    <span>暂无推荐组织</span>\n                </div>\n            </div>\n        )\n    }\n    // 渲染数据方法中\n    handelRender =(item)=>{\n\n        if(item.orgPortrait == null) {\n            var orgPortrait = require('../images/originImage.png')\n        }else {\n            orgPortrait = item.orgPortrait\n        }\n\n        return(\n\n            <div className='RecomComponent' key={item && item.orgId } onClick={this.getLianDataCard.bind(this,item.orgPortrait,item.orgId,item.orgRelationType,item.orgType,item.orgShortName,item.orgFullName,'','',item.orgIndustry,item.orgNetFlag)}>\n                <div className='componentImage' style={{background:'url('+orgPortrait+') no-repeat center center'}}></div>\n                <span>{item.orgShortName}</span>\n                <div className='address'>{item.officeAddressName}</div>\n                <b></b>\n                <div className='classBorder'></div>\n            </div>\n        )\n    }\n    handleRecomContent =()=>{\n        return (\n            <div className = 'recomConented' ref=\"scroll_container\">\n                {this.state.detailData.map(this.handelRender)}\n            </div>\n        )\n    }\n    render() { // isloading ：数据没有获取到之前 显示数据加载，\n\n        if(this.state.response ){\n            return this.handleOrign()\n        }\n\n        return this.handleRecomContent()\n    }\n}\nexport default RecomConent"]}