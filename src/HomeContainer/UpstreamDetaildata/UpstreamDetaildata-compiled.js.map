{"version":3,"sources":["UpstreamDetaildata.js"],"names":[],"mappings":"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","file":"UpstreamDetaildata-compiled.js","sourcesContent":["/**\n * Created by cvtt on 2017/4/7.\n */\nimport React,{Component} from 'react'\nimport './upStream.css'\nimport service from '../../services/movieService.js'\nexport default class UpstreamDetaildata extends Component {\n        constructor(props){\n            super(props)\n            this.state = {\n                industryName:'',\n                industryId:'',\n                responseEmpty:false,\n                responseArr:[],\n                isLoading:true,\n                lastOrgId:'',\n                isIndential:'',\n                datamessage:{},\n                propsType:'',\n                baginOrgIdRelease:2,\n                message:{\n                    type:'',\n                    count:20,\n                    industryId:'',\n                    region:''\n                }\n            }\n        }\n    componentWillMount(){\n        this.state.message.type = this.props.upStreamArr.type\n    }\n    // 当前子组件，获取行业id 地区 作为请求的参数获取数据\n    componentWillReceiveProps(nextProps){  // nextProps 获取的值要比 this.props 获取的值要快，用nextProps\n\n        if(nextProps.upStreamArr.type == 0 ){ // 只有在选择对应上游的时候type=0\n            this.state.message.type = nextProps.upStreamArr.type\n        }\n\n        this.setState({propsType:nextProps.upStreamArr.type})\n\n        if(nextProps.upStreamArr != this.props.upStreamArr) {//监测前后props属性有没有改变\n                //beginOrgId 是用来做下拉刷新,设置数据显示开始的位置,由于一个数据刷新完成以后，会给state lastorgId 设置上即，会保留，这样会设在下一个条件上,当更换条件的时候beginOrgId,就要的从头开始加载数据 (baginOrgIdRelease)\n\n            // 当前props属性值发生改变释放    isIndential = true\n            let PropsUpStream = nextProps.upStreamArr\n            this.setState({industryName:PropsUpStream.industryName,industryId:PropsUpStream.industryId,isIndential:true,baginOrgIdRelease:++this.state.baginOrgIdRelease})\n            if(this.state.baginOrgIdRelease >9){\n                this.setState({baginOrgIdRelease:2})\n            }\n            let messages = Object.assign({},this.state.message)\n            messages.industryId = PropsUpStream.industryId\n            messages.region = PropsUpStream.region\n            if(PropsUpStream.type){\n                messages.type = PropsUpStream.type\n            }\n\n            this.fetch(JSON.stringify(messages))\n        }\n\n    }\n\n    componentDidUpdate(){\n        if(this.refs.scroll_container){\n            this.addEventListener()\n        }\n    }\n\n    addEventListener=()=>{\n        const _this=this\n        this.refs.scroll_container.addEventListener('scroll',(e)=>{\n\n            e.stopPropagation\n            if(e.target.scrollHeight <=e.target.scrollTop + e.target.offsetHeight){\n                if(_this.state.isButton){\n                    return\n                }\n                // 在发送请求之前将上一次的 orgId 回传\n                if(this.state.datamessage.flag ==1){\n                    return\n                }\n\n                _this.setState({isButton:true,baginOrgIdRelease:1,isIndential:false}) //当下拉刷新的时候，表示是在当前条件,所以还是的需要的beginOrgId\n                _this.fetch(this.state.message,this.state.lastOrgId)\n            }\n        })\n    }\n    fetch =(message,lastOrgId)=>{ //\n         if(typeof (message)  == 'string') {\n             message = JSON.parse(message)\n         }\n        let messageObj = Object.assign({},message)\n\n        if(this.state.baginOrgIdRelease >3 ){//当页面初始加载的时候，baginOrgIdRelease ==2\n\n            messageObj.beginOrgId = ''\n        }else if(this.state.baginOrgIdRelease == 1)  { // 当下拉刷新的时候等于 1\n\n            messageObj.beginOrgId = this.state.lastOrgId || lastOrgId\n        }\n        let responseArr = [].concat(this.state.responseArr)\n        let messageStr = JSON.stringify(messageObj)\n        let promise = service.getSearchResult(messageStr)\n        promise.then((json)=>{\n\n            if(json ==''){\n                console.log('1111')\n\n                this.setState({responseEmpty:true,isLoading:false})\n                return\n            }\n            json = JSON.parse(json)\n           if(this.state.isIndential){//isIndential值为true,表示请求不同的数据\n               responseArr = []\n           }\n            if(responseArr.length>0){ // 数据刷新时执行\n\n                responseArr =  responseArr.concat(json.orgList)\n            }else{\n                responseArr =  json.orgList\n            }\n            if(this.state.baginOrgIdRelease >3 ){ // 当切换选择的条件  lastOrgId =''\n\n                this.setState({responseArr:responseArr,isLoading:false,lastOrgId:'',datamessage:json,responseEmpty:false})\n            }else {\n\n                this.setState({responseArr:responseArr,isLoading:false,lastOrgId:json.lastOrgId,datamessage:json,responseEmpty:false})\n            }\n\n\n        }),reason =>{\n            console.log(reason)\n        }\n    }\n    getLianDataCard =(Portrait,Id,RelationType,Type,ShortName,FullName,ContactName,Email,IndustryList,NetFlag,Th)=>{\n        var Iosmess = Object.assign({},this.state.Ios)\n        Iosmess.orgId = Id\n        Iosmess.orgType = Type\n        Iosmess.orgShortName = ShortName\n        Iosmess.orgPortrait = Portrait\n        var Strmess = JSON.stringify(Iosmess)\n        if(NetFlag == '1'){ // 表示跳转联网站\n            var uuu = navigator.userAgent;\n            var isAndroid=uuu.indexOf('Android') > -1 || uuu.indexOf('Linux') > -1;\n            var isIos=!!uuu.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/)==true;\n            if(isIos) {\n                window.webkit && window.webkit.messageHandlers.gotoWebsite.postMessage(Strmess)\n                return\n            }else if(isAndroid){\n\n                return  window.androidJsInterface && window.androidJsInterface.lianWebMainActivityLauncher(ShortName,Portrait,Id.toString(),RelationType.toString(),Type)\n            }\n        }else if(NetFlag == '0' ){ // 0\n\n            var uuu = navigator.userAgent;\n            var isAndroid=uuu.indexOf('Android') > -1 || uuu.indexOf('Linux') > -1;\n            var isIos=!!uuu.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/)==true;\n            if(isIos) {\n                window.webkit && window.webkit.messageHandlers.gotoOrgDetail.postMessage(Strmess)\n                return\n            }else if(isAndroid){\n\n                return   window.androidJsInterface && window.androidJsInterface.intationOrgCardActivityLauncher(Portrait,Id,Type,ShortName,FullName,ContactName,Email,JSON.stringify(IndustryList))\n\n            }\n        }\n    }\n    handleUpStreamDetail =(item,index)=>{ // 搜索组织详细展示\n        if(item.orgPortrait == null){\n            var orgPortrait = require('../../images/originImage.png')\n        }else {\n            orgPortrait = item.orgPortrait\n        }\n\n        return(\n\n            <div className='upStreamDetailOrgin' key={item && item.orgId } onClick={this.getLianDataCard.bind(this,item.orgPortrait,item.orgId,item.orgRelationType,item.orgType,item.orgShortName,item.orgFullName,'','',item.orgIndustry,item.orgNetFlag)}  >\n                <div className='upStreamImage' style={{background:'url('+orgPortrait+') no-repeat center center'}}></div>\n                <span>{item.orgShortName}</span>\n                <div className='upStreamaddress'>{item.officeAddressName}</div>\n                <b></b>\n                <div className='upStreamclassBorder'></div>\n            </div>\n        )\n    }\n    handleUpstream =()=>{\n\n          return (\n              <div className='upStreamDetailContainer' ref='scroll_container'>{ this.state.responseArr.map(this.handleUpStreamDetail)}</div>\n          )\n    }\n\n    handleResponseEmpty =()=> {\n        return(\n            <div className='upStreamResponEmpty'>\n                <div className='upStreamImage' >\n                    <img src={require('../../images/empty.png')} alt=\"\"/>\n                    <span>暂无搜索结果</span>\n                </div>\n            </div>\n        )\n\n    }\n     render(){\n\n           if(this.state.responseEmpty && this.state.isIndential){ //isIndential:当选择的条件变化值为true,下拉刷新的时候值为 false\n              return  this.handleResponseEmpty()\n           }\n              return this.handleUpstream()\n     }\n}\n\n"]}